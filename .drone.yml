# @Author: guiguan
# @Date:   2017-01-09T15:15:34+11:00
# @Last modified by:   guiguan
# @Last modified time: 2017-05-16T22:46:45+10:00



pipeline:
  cienvy:
    image: southbanksoftware/cienvy:node-nm-mongo
    pull: true
    volumes:
      - /Users/guiguan/Documents/Projects/SBS/cienvy-client:/cienvy-client
      - cienvy-volumes:/volumes
    commands:
      - set +x
      - bash /cienvy-client/bin/cienvy.bash --url=http://172.16.0.1:9090 prepare
      - tail -f /dev/null
  slack_legacy:
    image: plugins/slack
    pull: true
    volumes:
      - cienvy-volumes:/volumes
    secrets: [SLACK_WEBHOOK]
    webhook: ${SLACK_WEBHOOK}
    channel: ci
    template: >
      Build <{{build.link}}|{{build.number}}> (<https://github.com/{{repo.owner}}/{{repo.name}}/commit/{{build.commit}}|{{truncate build.commit 8}}>) of <https://github.com/{{repo.owner}}/{{repo.name}}|{{repo.owner}}/{{repo.name}}> has {{#success build.status}}succeeded{{else}}failed{{/success}} in {{since job.started}}
      <@{{build.author}}>: {{{build.message}}}
    when:
      status: [success, failure]
